<test>
    <query>
        SELECT number, avg(DISTINCT number) OVER () FROM numbers(0, 2_000_000) FORMAT Null;
    </query>

    <query>
        SELECT number, avg(DISTINCT number) OVER (ORDER BY number) FROM numbers(0, 2_000_000) FORMAT Null;
    </query>

    <query>
        SELECT number, avg(DISTINCT number) OVER (ORDER BY number ROWS BETWEEN UNBOUNDED PRECEDING AND 20 FOLLOWING)
        FROM numbers(0, 2_000_000) FORMAT Null;
    </query>

    <query>
        SELECT number, s, min(DISTINCT s) OVER(PARTITION BY number % 100_000) AS min_varlen_string
        FROM
        (
            SELECT number, toString(number % 200_000) AS s
            FROM numbers(2_000_000)
        ) FORMAT Null;
    </query>

    <query>
        SELECT s, ts, argMax(DISTINCT ts, s) OVER(PARTITION BY ts % 100_000) AS value_with_max_ts
        FROM
        (
            SELECT number AS ts, toString(number % 200_000) AS s
            FROM numbers(2_000_000)
        ) FORMAT Null;
    </query>
</test>
